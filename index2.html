<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì„  ìŠ¤í™íŠ¸ëŸ¼ìœ¼ë¡œ ì›ì†Œ ì°¾ê¸° (ë¯¸ì§€ ìŠ¤í™íŠ¸ëŸ¼ ì •ë ¬)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 15px 20px;
      max-width: 720px;
      margin: auto;
      font-size: 14px;
      line-height: 1.3;
    }
    h1 {
      font-size: 1.6em;
      margin-bottom: 10px;
    }
    .question {
      font-size: 1.1em;
      margin-bottom: 12px;
    }

    /* ê³µí†µ ìŠ¤í™íŠ¸ëŸ¼ ìŠ¤íƒ€ì¼ */
    .spectrum {
      width: 320px;
      background: black;
      height: 28px;
      position: relative;
      border-radius: 3px;
      user-select: none;
      box-sizing: border-box;
      margin: 0;
    }

    /* ë¯¸ì§€ ìŠ¤í™íŠ¸ëŸ¼ + í…ìŠ¤íŠ¸ flex ì •ë ¬ */
    .unknown-container {
      display: flex;
      align-items: center;
      margin: 6px 0 12px 0;
      font-weight: 600;
      font-size: 0.95em;
      gap: 9px;
    }
    .unknown-container strong {
      flex: 0 0 90px; /* í…ìŠ¤íŠ¸ ê³ ì •í­ */
    }

    /* ë³´ê¸° í…ìŠ¤íŠ¸ + ìŠ¤í™íŠ¸ëŸ¼ flex ë°°ì¹˜ */
    #elementSpectra p {
      display: flex;
      align-items: center;
      margin: 6px 0 8px 0;
      font-weight: 600;
      font-size: 0.95em;
    }
    #elementSpectra p strong {
      flex: 0 0 90px;
    }
    #elementSpectra .spectrum {
      flex-shrink: 0;
      margin: 0;
    }

    /* ìŠ¤í™íŠ¸ëŸ¼ ì„  ìŠ¤íƒ€ì¼ */
    .line {
      position: absolute;
      width: 2.5px;
      height: 100%;
      border-radius: 1px;
    }

    form {
      margin-top: 10px;
      margin-bottom: 6px;
    }
    .element-list label {
      margin-right: 14px;
      cursor: pointer;
      font-size: 0.9em;
      user-select: none;
    }
    button {
      margin-left: 8px;
      font-size: 0.95em;
      padding: 5px 12px;
      cursor: pointer;
      border-radius: 4px;
      border: 1px solid #555;
      background: #f0f0f0;
      transition: background 0.2s ease;
    }
    button:hover {
      background: #ddd;
    }
    #result {
      min-height: 2em;
      margin-top: 12px;
      font-weight: 700;
    }
  </style>
</head>
<body>

  <h1>ğŸŒˆ ì„  ìŠ¤í™íŠ¸ëŸ¼ìœ¼ë¡œ ì›ì†Œ ì°¾ê¸° (ë¯¸ì§€ ìŠ¤í™íŠ¸ëŸ¼ ì •ë ¬)</h1>

  <div class="question" id="questionText"></div>

  <h3>ë¯¸ì§€ì˜ ìŠ¤í™íŠ¸ëŸ¼</h3>
  <div class="unknown-container">
    <strong>ë¯¸ì§€ ìŠ¤í™íŠ¸ëŸ¼</strong>
    <div class="spectrum" id="unknown"></div>
  </div>

  <h3>ë³´ê¸°: ì›ì†Œ ìŠ¤í™íŠ¸ëŸ¼</h3>
  <div id="elementSpectra"></div>

  <form id="answerForm">
    <fieldset class="element-list" id="answerOptions">
      <!-- ì²´í¬ë°•ìŠ¤ ë™ì  ìƒì„± -->
    </fieldset>
  </form>

  <button onclick="checkAnswer()">ì •ë‹µ í™•ì¸</button>
  <button onclick="loadProblem()">ë‹¤ìŒ ë¬¸ì œ â–¶</button>

  <div id="result"></div>

<script>
  const WAVELENGTH_MIN = 400;
  const WAVELENGTH_MAX = 800;
  const SPECTRUM_WIDTH = 320; // px

  const elements = {
    H: { wl: [656, 486], name: "ìˆ˜ì†Œ(H)" },
    He: { wl: [447, 501, 587], name: "í—¬ë¥¨(He)" },
    Na: { wl: [589], name: "ë‚˜íŠ¸ë¥¨(Na)" },
    O: { wl: [630, 636], name: "ì‚°ì†Œ(O)" },
    K: { wl: [766, 770], name: "ì¹¼ë¥¨(K)" },
    Ca: { wl: [422, 443], name: "ì¹¼ìŠ˜(Ca)" }
  };

  const problems = [
    { question: "ìˆ˜ì†Œì™€ í—¬ë¥¨ì´ í˜¼í•©ëœ ìŠ¤í™íŠ¸ëŸ¼ì…ë‹ˆë‹¤. í¬í•¨ëœ ì›ì†Œë¥¼ ëª¨ë‘ ê³ ë¥´ì„¸ìš”.", answer: ["H", "He"], unknown: [...elements.H.wl, ...elements.He.wl] },
    { question: "ë‚˜íŠ¸ë¥¨ê³¼ ì‚°ì†Œê°€ í˜¼í•©ëœ ìŠ¤í™íŠ¸ëŸ¼ì…ë‹ˆë‹¤. í¬í•¨ëœ ì›ì†Œë¥¼ ëª¨ë‘ ê³ ë¥´ì„¸ìš”.", answer: ["Na", "O"], unknown: [...elements.Na.wl, ...elements.O.wl] },
    { question: "ì¹¼ë¥¨ê³¼ ì¹¼ìŠ˜ì´ í¬í•¨ëœ ìŠ¤í™íŠ¸ëŸ¼ì…ë‹ˆë‹¤. í¬í•¨ëœ ì›ì†Œë¥¼ ëª¨ë‘ ê³ ë¥´ì„¸ìš”.", answer: ["K", "Ca"], unknown: [...elements.K.wl, ...elements.Ca.wl] },
    { question: "ìˆ˜ì†Œ, ë‚˜íŠ¸ë¥¨, ì¹¼ìŠ˜ ì„¸ ì›ì†Œê°€ í˜¼í•©ëœ ìŠ¤í™íŠ¸ëŸ¼ì…ë‹ˆë‹¤. í¬í•¨ëœ ì›ì†Œë¥¼ ëª¨ë‘ ê³ ë¥´ì„¸ìš”.", answer: ["H", "Na", "Ca"], unknown: [...elements.H.wl, ...elements.Na.wl, ...elements.Ca.wl] },
    { question: "í—¬ë¥¨ê³¼ ì¹¼ë¥¨ì´ í¬í•¨ëœ ìŠ¤í™íŠ¸ëŸ¼ì…ë‹ˆë‹¤. í¬í•¨ëœ ì›ì†Œë¥¼ ëª¨ë‘ ê³ ë¥´ì„¸ìš”.", answer: ["He", "K"], unknown: [...elements.He.wl, ...elements.K.wl] },
    { question: "ìˆ˜ì†Œ, ì‚°ì†Œ, ì¹¼ìŠ˜ ì„¸ ì›ì†Œê°€ í˜¼í•©ëœ ìŠ¤í™íŠ¸ëŸ¼ì…ë‹ˆë‹¤. í¬í•¨ëœ ì›ì†Œë¥¼ ëª¨ë‘ ê³ ë¥´ì„¸ìš”.", answer: ["H", "O", "Ca"], unknown: [...elements.H.wl, ...elements.O.wl, ...elements.Ca.wl] },
    { question: "ë‚˜íŠ¸ë¥¨, ì¹¼ë¥¨, ì‚°ì†Œê°€ í¬í•¨ëœ ìŠ¤í™íŠ¸ëŸ¼ì…ë‹ˆë‹¤. í¬í•¨ëœ ì›ì†Œë¥¼ ëª¨ë‘ ê³ ë¥´ì„¸ìš”.", answer: ["Na", "K", "O"], unknown: [...elements.Na.wl, ...elements.K.wl, ...elements.O.wl] },
    { question: "í—¬ë¥¨, ì¹¼ìŠ˜, ìˆ˜ì†Œê°€ í¬í•¨ëœ ìŠ¤í™íŠ¸ëŸ¼ì…ë‹ˆë‹¤. í¬í•¨ëœ ì›ì†Œë¥¼ ëª¨ë‘ ê³ ë¥´ì„¸ìš”.", answer: ["He", "Ca", "H"], unknown: [...elements.He.wl, ...elements.Ca.wl, ...elements.H.wl] },
    { question: "ìˆ˜ì†Œ, í—¬ë¥¨, ë‚˜íŠ¸ë¥¨, ì‚°ì†Œê°€ í˜¼í•©ëœ ìŠ¤í™íŠ¸ëŸ¼ì…ë‹ˆë‹¤. í¬í•¨ëœ ì›ì†Œë¥¼ ëª¨ë‘ ê³ ë¥´ì„¸ìš”.", answer: ["H", "He", "Na", "O"], unknown: [...elements.H.wl, ...elements.He.wl, ...elements.Na.wl, ...elements.O.wl] },
    { question: "ì¹¼ìŠ˜ê³¼ ì‚°ì†Œê°€ í¬í•¨ëœ ìŠ¤í™íŠ¸ëŸ¼ì…ë‹ˆë‹¤. í¬í•¨ëœ ì›ì†Œë¥¼ ëª¨ë‘ ê³ ë¥´ì„¸ìš”.", answer: ["Ca", "O"], unknown: [...elements.Ca.wl, ...elements.O.wl] },
    { question: "ì¹¼ë¥¨ê³¼ ìˆ˜ì†Œê°€ í¬í•¨ëœ ìŠ¤í™íŠ¸ëŸ¼ì…ë‹ˆë‹¤. í¬í•¨ëœ ì›ì†Œë¥¼ ëª¨ë‘ ê³ ë¥´ì„¸ìš”.", answer: ["K", "H"], unknown: [...elements.K.wl, ...elements.H.wl] },
    { question: "í—¬ë¥¨, ë‚˜íŠ¸ë¥¨, ì¹¼ìŠ˜ì´ í¬í•¨ëœ ìŠ¤í™íŠ¸ëŸ¼ì…ë‹ˆë‹¤. í¬í•¨ëœ ì›ì†Œë¥¼ ëª¨ë‘ ê³ ë¥´ì„¸ìš”.", answer: ["He", "Na", "Ca"], unknown: [...elements.He.wl, ...elements.Na.wl, ...elements.Ca.wl] }
  ];

  let currentProblem;

  function wavelengthToPosition(wl) {
    if (wl < WAVELENGTH_MIN) wl = WAVELENGTH_MIN;
    if (wl > WAVELENGTH_MAX) wl = WAVELENGTH_MAX;
    const ratio = (wl - WAVELENGTH_MIN) / (WAVELENGTH_MAX - WAVELENGTH_MIN);
    return ratio * SPECTRUM_WIDTH;
  }

  function drawSpectrum(id, lines) {
    const container = document.getElementById(id);
    lines.forEach(wl => {
      const line = document.createElement("div");
      line.className = "line";
      line.style.background = `rgb(${wavelengthToRGB(wl).join(",")})`;
      line.style.left = `${wavelengthToPosition(wl)}px`;
      container.appendChild(line);
    });
  }

  function clearSpectrum(id) {
    document.getElementById(id).innerHTML = "";
  }

  function wavelengthToRGB(wl) {
    if (wl < 450) return [0, 0, 255];
    if (wl < 495) return [0, 255, 255];
    if (wl < 570) return [0, 255, 0];
    if (wl < 590) return [255, 255, 0];
    if (wl < 620) return [255, 165, 0];
    return [255, 0, 0];
  }

  function loadProblem() {
    clearSpectrum("unknown");
    clearSpectrum("elementSpectra");
    document.getElementById("result").innerText = "";

    currentProblem = problems[Math.floor(Math.random() * problems.length)];
    document.getElementById("questionText").innerText = `[ë¬¸ì œ] ${currentProblem.question}`;

    drawSpectrum("unknown", currentProblem.unknown);

    const elementSpectraDiv = document.getElementById("elementSpectra");
    const answerOptions = document.getElementById("answerOptions");
    answerOptions.innerHTML = "";

    Object.entries(elements).forEach(([key, el]) => {
      const p = document.createElement("p");
      p.innerHTML = `<strong>${el.name}</strong>`;
      const spectrumDiv = document.createElement("div");
      spectrumDiv.className = "spectrum";
      spectrumDiv.id = `spec_${key}`;
      p.appendChild(spectrumDiv);
      elementSpectraDiv.appendChild(p);

      drawSpectrum(spectrumDiv.id, el.wl);

      const label = document.createElement("label");
      const checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      checkbox.value = key;
      checkbox.name = "element";
      label.appendChild(checkbox);
      label.appendChild(document.createTextNode(el.name));
      answerOptions.appendChild(label);
    });
  }

  function checkAnswer() {
    const checkedEls = [...document.querySelectorAll('input[name="element"]:checked')].map(cb => cb.value);
    const correct = currentProblem.answer;
    const result = document.getElementById("result");

    const correctSet = new Set(correct);
    const checkedSet = new Set(checkedEls);

    const correctPicked = checkedEls.filter(x => correctSet.has(x));
    const missed = correct.filter(x => !checkedSet.has(x));
    const wrongPicked = checkedEls.filter(x => !correctSet.has(x));

    if (missed.length === 0 && wrongPicked.length === 0) {
      result.innerHTML = `âœ… ì •ë‹µì…ë‹ˆë‹¤! ì˜ ë§ì¶”ì…¨ì–´ìš”.<br>ì„ íƒí•œ ì›ì†Œ: ${correctPicked.map(x => elements[x].name).join(", ")}`;
      result.style.color = "green";
    } else {
      let msg = "âŒ ì˜¤ë‹µì…ë‹ˆë‹¤.<br>";
      if (missed.length > 0) msg += `âœ ëˆ„ë½ëœ ì›ì†Œ: ${missed.map(x => elements[x].name).join(", ")}<br>`;
      if (wrongPicked.length > 0) msg += `âœ í‹€ë¦¬ê²Œ ì„ íƒí•œ ì›ì†Œ: ${wrongPicked.map(x => elements[x].name).join(", ")}`;
      result.innerHTML = msg;
      result.style.color = "red";
    }
  }

  window.onload = loadProblem;
</script>

</body>
</html>
