<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>상황별 광합성 조건 예측</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 30px;
      max-width: 720px;
      margin: auto;
    }
    label, select {
      font-weight: bold;
      font-size: 14px;
    }
    .slider-container {
      margin: 15px 0;
    }
    .result, .ai-result {
      background: #eef;
      margin-top: 20px;
      padding: 15px;
      border-left: 5px solid #3a7;
      white-space: pre-wrap; /* 줄바꿈 유지 */
    }
    button {
      margin-top: 10px;
      padding: 10px;
      background-color: #4CAF50;
      border: none;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #388e3c;
    }
  </style>
</head>
<body>

  <h2>🌿 상황별 광합성 예측 모델</h2>
  <p>다양한 식물 환경 상황을 선택하고, 온도, 빛 세기, CO₂ 농도를 조절하여 광합성량을 탐구해 보세요.</p>

  <label for="scenario">🌍 상황 선택:</label>
  <select id="scenario" onchange="updateValues()">
    <option value="tropical">① 열대 식물 (고온다습)</option>
    <option value="winter">② 겨울철 온실 (저온, 빛 부족)</option>
    <option value="mountain">③ 고산 식물 (CO₂ 낮음)</option>
    <option value="desert">④ 사막 식물 (고온, 빛 강함, 물 부족)</option>
  </select>

  <div class="slider-container">
    <label>🌡️ 온도 (°C): <span id="tempVal">25</span></label>
    <input type="range" id="temp" min="0" max="50" value="25">
  </div>

  <div class="slider-container">
    <label>💡 빛 세기 (lux): <span id="lightVal">5000</span></label>
    <input type="range" id="light" min="0" max="10000" value="5000" step="100">
  </div>

  <div class="slider-container">
    <label>🌬️ CO₂ 농도 (ppm): <span id="co2Val">400</span></label>
    <input type="range" id="co2" min="200" max="1000" value="400" step="10">
  </div>

  <div class="result" id="photosynthesisRate">🌱 광합성량: 계산 중...</div>

  <button onclick="predictOptimal()">🤖 AI 도우미: 최적 조건 보기</button>
  <div class="ai-result" id="aiResult">AI 예측 결과가 여기에 표시됩니다.</div>

  <script>
    const tempSlider = document.getElementById('temp');
    const lightSlider = document.getElementById('light');
    const co2Slider = document.getElementById('co2');

    const tempVal = document.getElementById('tempVal');
    const lightVal = document.getElementById('lightVal');
    const co2Val = document.getElementById('co2Val');
    const rateDisplay = document.getElementById('photosynthesisRate');
    const aiResult = document.getElementById('aiResult');
    const scenarioSelect = document.getElementById('scenario');

    function getScenarioSettings() {
      const scenario = scenarioSelect.value;

      switch (scenario) {
        case 'tropical': return { temp: 30, light: 8000, co2: 700 };
        case 'winter': return { temp: 20, light: 3000, co2: 500 };
        case 'mountain': return { temp: 18, light: 6000, co2: 350 };
        case 'desert': return { temp: 35, light: 9000, co2: 600 };
        default: return { temp: 25, light: 5000, co2: 400 };
      }
    }

    function calculatePhotosynthesis(temp, light, co2, scenario) {
      const opt = getScenarioSettings();

      const tempFactor = Math.exp(-Math.pow((temp - opt.temp) / 10, 2));
      const lightFactor = Math.exp(-Math.pow((light - opt.light) / 2000, 2));
      const co2Factor = Math.exp(-Math.pow((co2 - opt.co2) / 200, 2));

      return tempFactor * lightFactor * co2Factor * 100;
    }

    function updateValues() {
      const temp = parseInt(tempSlider.value);
      const light = parseInt(lightSlider.value);
      const co2 = parseInt(co2Slider.value);

      tempVal.textContent = temp;
      lightVal.textContent = light;
      co2Val.textContent = co2;

      const scenario = scenarioSelect.value;
      const rate = calculatePhotosynthesis(temp, light, co2, scenario);
      rateDisplay.textContent = `🌱 광합성량: ${rate.toFixed(2)} (모의 값)`;
      aiResult.textContent = "AI 예측 결과가 여기에 표시됩니다.";
    }

    function predictOptimal() {
      const scenario = scenarioSelect.value;
      let best = { rate: -1, temp: 0, light: 0, co2: 0 };

      for (let t = 10; t <= 40; t += 1) {
        for (let l = 1000; l <= 9000; l += 500) {
          for (let c = 300; c <= 800; c += 50) {
            const rate = calculatePhotosynthesis(t, l, c, scenario);
            if (rate > best.rate) {
              best = { rate, temp: t, light: l, co2: c };
            }
          }
        }
      }

      let explanation = "";
      switch (scenario) {
        case "tropical":
          explanation = `열대 식물은 고온다습한 환경에서 잘 자랍니다. 온도가 높을수록 광합성에 관여하는 효소들의 활동이 활발해지고,\n빛과 CO₂가 풍부하면 광합성 속도가 증가합니다.\n따라서 높은 온도와 강한 빛, 높은 CO₂ 농도가 최적 조건이 됩니다.`;
          break;
        case "winter":
          explanation = `겨울철 온실은 낮은 온도와 빛 부족 환경이므로, 효율적인 광합성을 위해 적당한 온도와 빛 조건을 유지하는 것이 중요합니다.\nCO₂ 농도는 상대적으로 높을수록 광합성에 도움이 됩니다.`;
          break;
        case "mountain":
          explanation = `고산 지역은 기온이 낮고 공기 중 CO₂ 농도가 낮아 식물이 광합성에 적응하기 어렵습니다.\n따라서 적절한 온도와 빛을 확보하고 낮은 CO₂ 농도에서도 최대한 효율적으로 작용하는 조건이 필요합니다.`;
          break;
        case "desert":
          explanation = `사막 식물은 강한 햇빛과 고온 환경에 적응해 있으며, 수분 손실을 줄이기 위해 광합성 효율을 높여야 합니다.\n따라서 고온과 강한 빛 조건에서 CO₂ 농도는 중간 수준이 최적입니다.`;
          break;
        default:
          explanation = `선택한 시나리오에 따라 식물의 생육 환경과 광합성 최적 조건이 다릅니다.`;
      }

      aiResult.innerHTML = `
        ✅ <strong>${scenarioSelect.options[scenarioSelect.selectedIndex].text}</strong>의 최적 조건:<br>
        온도: <strong>${best.temp}°C</strong><br>
        빛 세기: <strong>${best.light} lux</strong><br>
        CO₂ 농도: <strong>${best.co2} ppm</strong><br>
        예상 광합성량: <strong>${best.rate.toFixed(2)}</strong><br><br>
        🔍 <strong>AI 설명:</strong><br>${explanation}
      `;
    }

    tempSlider.oninput = updateValues;
    lightSlider.oninput = updateValues;
    co2Slider.oninput = updateValues;
    scenarioSelect.onchange = updateValues;

    updateValues();
  </script>

</body>
</html>
